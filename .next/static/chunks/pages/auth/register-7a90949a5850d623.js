(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[461],{6659:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth/register",function(){return s(3401)}])},3401:function(e,t,s){"use strict";s.r(t),s.d(t,{Register:function(){return T},default:function(){return L}});var n=s(5893),a=s(5281),i=s(6859),r=s(829),o=s(4285),l=s(2497),c=s(9381),d=s(2503),u=s(2757),h=s(7294),g=s(6824);class m{static get instance(){return m._instance||(m._instance=new m),m._instance}checkEmail(e){return/^[a-zA-Z0-9]+@[a-zA-Z0-9]+\.[A-Za-z]+$/.test(e)}checkPassword(e){return/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/.test(e)}checkNickname(e){return!(e.length<2||e.length>10||/^\d+$/.test(e)||/[^가-힣a-zA-Z0-9]/.test(e))}checkNumber(e){return/^[0-9]*$/.test(e)}constructor(){}}var p=s(856),f=s(44),x=s(4121);let C=[{description:"이메일 인증"},{description:"인증 번호 입력"},{description:"기타 정보 입력"}],w=()=>{let{activeStep:e,setActiveStep:t}=(0,g.h)({index:0,count:C.length}),{toMain:s}=(0,p.q)(),[n,a]=(0,h.useState)({email:"",emailCode:"",password:"",passwordCheck:"",username:"",image:""}),[i,r]=(0,h.useState)({loadingEmailCode:!1,loadingEmailCodeSubmit:!1,loadingRegister:!1}),o=()=>t(e=>e+1),l=async()=>{let e=m.instance.checkPassword(n.password);if(!e){alert("비밀번호 형식이 올바르지 않습니다.");return}if(n.password!==n.passwordCheck){alert("비밀번호가 일치하지 않습니다.");return}let t=m.instance.checkNickname(n.username);if(!t){alert("닉네임 형식이 올바르지 않습니다. (2~10자)");return}r(e=>({...e,loadingRegister:!0}));let a=await f.e.register(n.email,n.password,n.username,n.imageFile);a.isSuccess?await s():alert("회원가입 실패: ".concat(a.message))};return{form:n,handleInputChange:e=>{console.log(e.target.name,e.target.value),a({...n,[e.target.name]:e.target.value})},handleImageChange:e=>{if(e.target.files){let t=e.target.files[0];if(t.size>10485760){alert("파일 용량이 너무 큽니다. (10MB 이하)");return}let s=new FileReader;s.onloadend=()=>a({...n,image:s.result,imageFile:t}),s.readAsDataURL(t)}},activeStep:e,setActiveStep:t,steps:C,requestCodeSend:()=>{let e=m.instance.checkEmail(n.email);if(!e){alert("이메일 형식이 올바르지 않습니다.");return}r(e=>({...e,loadingEmailCode:!0})),o(),r(e=>({...e,loadingEmailCode:!1}))},requestCodeSubmit:e=>{r(e=>({...e,loadingEmailCodeSubmit:!0})),x.Z.info(e),o(),r(e=>({...e,loadingEmailCodeSubmit:!1}))},requestRegister:l,loadings:i}};var j=s(8049),E=s(9371),b=s(3090),y=s(3108),S=s(3484);let R=e=>{let{handleInputChange:t,requestCodeSend:s,loadingEmailCode:a}=e;return(0,n.jsxs)(j.NI,{isRequired:!0,width:"80%",children:[(0,n.jsx)(E.l,{children:"이메일"}),(0,n.jsx)(b.I,{placeholder:"mindcraft@example.com",mb:3,type:"email",name:"email",onChange:t}),(0,n.jsx)(y.z,{width:"100%",color:"white",bg:S.O.key,onClick:s,isLoading:a,children:"인증 메일 발송"})]})};var _=s(4292),v=s(7431);let I=e=>{let{requestCodeSubmit:t,loadingEmailCodeSubmit:s}=e;return(0,n.jsx)(a.K,{children:(0,n.jsxs)(j.NI,{display:"flex",flexDirection:"column",justifyContent:"center",isRequired:!0,children:[(0,n.jsx)(E.l,{children:"인증 번호"}),(0,n.jsx)(_.U,{children:(0,n.jsxs)(v.E,{onComplete:t,isDisabled:s,children:[(0,n.jsx)(v.x,{}),(0,n.jsx)(v.x,{}),(0,n.jsx)(v.x,{}),(0,n.jsx)(v.x,{})]})})]})})};var q=s(5460);let A=e=>{let{handleInputChange:t,handleImageChange:s,requestRegister:i,loadingRegister:r,image:o}=e;return console.log(o),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.K,{direction:"row",width:"full",justifyContent:"space-between",children:[(0,n.jsx)(a.K,{width:"55%",display:"flex",alignItems:"center",children:(0,n.jsxs)(j.NI,{isRequired:!0,children:[(0,n.jsx)(E.l,{children:"비밀번호"}),(0,n.jsx)(b.I,{placeholder:"비밀번호",mb:3,type:"password",name:"password",onChange:t}),(0,n.jsx)(b.I,{placeholder:"비밀번호 확인",mb:3,type:"password",name:"passwordCheck",onChange:t}),(0,n.jsx)(E.l,{children:"닉네임"}),(0,n.jsx)(b.I,{placeholder:"닉네임",mb:3,type:"text",name:"username",onChange:t})]})}),(0,n.jsx)(a.K,{width:"40%",display:"flex",alignItems:"center",height:"full",children:(0,n.jsxs)(j.NI,{children:[(0,n.jsxs)(E.l,{boxSize:"full",children:["프로필 이미지",(0,n.jsx)(q.E,{src:o,aspectRatio:1,objectFit:"cover",borderRadius:8,fallbackSrc:"https://via.placeholder.com/150"})]}),(0,n.jsx)(b.I,{hidden:!0,type:"file",accept:"image/*",name:"image",onChange:s})]})})]}),(0,n.jsx)(y.z,{width:"100%",color:"white",bg:S.O.key,onClick:i,isLoading:r,children:"회원 가입 요청"})]})};var k=s(9094);function T(){let e=w(),t=e.steps[e.activeStep].description,{auth:s}=(0,k.a)(),{toMain:g}=(0,p.q)();return(0,h.useEffect)(()=>{s&&g()},[]),(0,n.jsxs)(a.K,{maxW:"400px",mx:"auto",my:"8vh",direction:"column",alignItems:"center",children:[(0,n.jsx)(a.K,{width:"100%",children:(0,n.jsx)(i.v,{width:"60%",mx:"auto",size:"sm",index:e.activeStep,gap:"1",children:e.steps.map((e,t)=>(0,n.jsxs)(r.h,{children:[(0,n.jsx)(o.O,{children:(0,n.jsx)(l.k,{complete:(0,n.jsx)(c.Z,{})})}),(0,n.jsx)(d.F,{})]},t))})}),(0,n.jsx)(u.X,{width:"full",textAlign:"center",my:30,children:t}),0===e.activeStep?(0,n.jsx)(R,{handleInputChange:e.handleInputChange,requestCodeSend:e.requestCodeSend,loadingEmailCode:e.loadings.loadingEmailCode}):1===e.activeStep?(0,n.jsx)(I,{requestCodeSubmit:e.requestCodeSubmit,loadingEmailCodeSubmit:e.loadings.loadingEmailCodeSubmit}):2===e.activeStep?(0,n.jsx)(A,{handleInputChange:e.handleInputChange,handleImageChange:e.handleImageChange,requestRegister:e.requestRegister,loadingRegister:e.loadings.loadingRegister,image:e.form.image}):null]})}var L=T},44:function(e,t,s){"use strict";s.d(t,{e:function(){return f}});var n,a,i,r,o,l,c,d,u=s(6154);(n=l||(l={})).get="get",n.post="post",n.put="put",n.delete="delete",(a=c||(c={})).json="application/json",a.form="multipart/form-data",(r=(i=d||(d={})).auth||(i.auth={})).signIn={method:l.post,url:"/auth/login"},r.register={method:l.post,url:"/auth/signup",contentType:c.form},r.requestCode={method:l.post,url:"/auth/email"},r.requestCodeSubmit={method:l.post,url:"/auth/email/verify"},(o=i.test||(i.test={})).getTestList={method:l.get,url:"/mindTestes"},o.getTestDetail={method:l.get,url:"/mindTestes/:id"},o.createTest={method:l.post,url:"/mindTest"};class h{constructor(e,t,s){this.statusCode=e,this.message=t,this.data=s,this.isSuccess=200===e,this.isError=200!==e,this.isTokenExpired=401===e||403===e}}var g=s(4121),m=s(3454);class p{static get instance(){return p._instance||(p._instance=new p),p._instance}constructor(){this.setConfig=(e,t)=>{let s=e.url;if(t)for(let[e,n]of Object.entries(t))s.includes(":".concat(e))&&(s=s.replace(":".concat(e),n),delete t[e]);let n={method:e.method,url:s};return e.method===l.get?n.params=t:e.contentType===c.form?n.data=this.transToFromData(t):n.data=t,n},this.request=async(e,t)=>{let s=this.setConfig(e,t);try{let e=await this.axios.request(s),n=new h(e.data.statusCode,e.data.message,e.data.data);return n.isError?this.failLog(s,t,e.data):this.successLog(s,t,n),n}catch(i){let s;let n=500;i.response?(n=i.response.status,s="http 응답 실패"):i.request?s=i.message:(s=i.message,n=501);let a=new h(n,s);return this.errorLog(e,t,i,a),a}},this.transToFromData=e=>{let t=new FormData;for(let s in e){let n=e[s];if("string"==typeof n||n instanceof Blob||n instanceof File)t.set(s,n);else if(Array.isArray(n))for(let e of n)("string"==typeof e||e instanceof Blob||e instanceof File)&&t.set(s,e);else null!=n&&t.set(s,String(n))}return console.log(t),t},this.errorLog=(e,t,s,n)=>{g.Z.error("\n====REQUEST====","\nBaseUrl\n",m.env.REACT_APP_API_BASE_URL,"\napiConfig\n",e,"\nbody\n",t,"\n\n=====ERROR=====","\ndata\n",n,"\nerror\n",s)},this.failLog=(e,t,s)=>{g.Z.warn("\n====REQUEST====","\nBaseUrl\n",m.env.REACT_APP_API_BASE_URL,"\napiConfig\n",e,"\nbody\n",t,"\n\n=====ERROR=====","\nResponse\n",s)},this.successLog=(e,t,s)=>{g.Z.log("\n====REQUEST====","\nBaseUrl\n",m.env.REACT_APP_API_BASE_URL,"\napiConfig\n",e,"\nbody\n",t,"\n\n====RESPONSE====\n",s)},this.axios=u.Z.create({baseURL:"http://ec2-3-39-232-89.ap-northeast-2.compute.amazonaws.com:8080"})}}class f{static async register(e,t,s,n){return await p.instance.request(d.auth.register,{email:e,password:t,username:s,profileImage:n})}static async signIn(e,t){return await p.instance.request(d.auth.signIn,{email:e,password:t})}static async requestCode(e){return await p.instance.request(d.auth.requestCode,{email:e})}static async requestCodeSubmit(e,t){return await p.instance.request(d.auth.requestCodeSubmit,{email:e,code:t})}}},4121:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});class n{static log(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];this.isDebug()&&console.log(...t)}static info(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];this.isDebug()&&console.info(...t)}static warn(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];this.isDebug()&&console.warn(...t)}static error(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];this.isDebug()&&console.error(...t)}}n.isDebug=()=>!1}},function(e){e.O(0,[876,496,902,774,888,179],function(){return e(e.s=6659)}),_N_E=e.O()}]);