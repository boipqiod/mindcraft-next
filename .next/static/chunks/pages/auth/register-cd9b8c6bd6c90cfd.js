(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[461],{6659:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth/register",function(){return a(1338)}])},1338:function(e,t,a){"use strict";a.r(t),a.d(t,{Register:function(){return ea},default:function(){return en}});var n=a(5893),i=a(5281),l=a(5227),s=a(5607),[r,o]=(0,l.k)({name:"StepContext"}),[c,u]=(0,s.eC)("Stepper"),d=a(5432),m=a(6554),h=a(7603),p=a(3179),g=a(6914),x=a(7294),f=(0,m.G)(function(e,t){let a=(0,h.jC)("Stepper",e),{children:i,index:l,orientation:s="horizontal",showLastSeparator:o=!1,...u}=(0,p.Lr)(e),m=x.Children.toArray(i),f=m.length;return(0,n.jsx)(g.m.div,{ref:t,"aria-label":"Progress","data-orientation":s,...u,__css:a.stepper,className:(0,d.cx)("chakra-stepper",e.className),children:(0,n.jsx)(c,{value:a,children:m.map((e,t)=>(0,n.jsx)(r,{value:{index:t,status:t<l?"complete":t>l?"incomplete":"active",orientation:s,showLastSeparator:o,count:f,isFirst:0===t,isLast:t===f-1},children:e},t))})})}),j=(0,m.G)(function(e,t){let{orientation:a,status:i,showLastSeparator:l}=o(),s=u();return(0,n.jsx)(g.m.div,{ref:t,"data-status":i,"data-orientation":a,"data-stretch":(0,d.PB)(l),__css:s.step,...e,className:(0,d.cx)("chakra-step",e.className)})});function C(e){let{status:t}=o(),a=u();return(0,n.jsx)(g.m.div,{"data-status":t,...e,__css:a.indicator,className:(0,d.cx)("chakra-step__indicator",e.className)})}function v(e){let{complete:t,incomplete:a,active:i}=e,l=o(),s=null;switch(l.status){case"complete":s=(0,d.Pu)(t,l);break;case"incomplete":s=(0,d.Pu)(a,l);break;case"active":s=(0,d.Pu)(i,l)}return s?(0,n.jsx)(n.Fragment,{children:s}):null}function w(e){return(0,n.jsx)("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 20 20","aria-hidden":"true",height:"1em",width:"1em",...e,children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}var k=a(6948);function b(e){let{status:t}=o(),a=u();return(0,n.jsx)(k.J,{as:"complete"===t?w:void 0,__css:a.icon,...e,className:(0,d.cx)("chakra-step__icon",e.className)})}var _=(0,m.G)(function(e,t){let{orientation:a,status:i,isLast:l,showLastSeparator:s}=o(),r=u();return l&&!s?null:(0,n.jsx)(g.m.div,{ref:t,role:"separator","data-orientation":a,"data-status":i,__css:r.separator,...e,className:(0,d.cx)("chakra-step__separator",e.className)})}),S=a(2757);class y{static get instance(){return y._instance||(y._instance=new y),y._instance}checkEmail(e){return/^[a-zA-Z0-9._]+@[a-zA-Z0-9]+\.[A-Za-z]+$/.test(e)}checkPassword(e){return/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/.test(e)}checkNickname(e){return!(e.length<2||e.length>10||/^\d+$/.test(e)||/[^가-힣a-zA-Z0-9]/.test(e))}checkNumber(e){return/^[0-9]*$/.test(e)}constructor(){}}var I=a(856),N=a(2455);let E=[{description:"이메일 인증"},{description:"인증 번호 입력"},{description:"기타 정보 입력"}],A=()=>{let{activeStep:e,setActiveStep:t}=function(e={}){let{index:t=0,count:a}=e,[n,i]=(0,x.useState)(t),l="number"==typeof a?a-1:0;return{activeStep:n,setActiveStep:i,activeStepPercent:n/l,isActiveStep:e=>e===n,isCompleteStep:e=>e<n,isIncompleteStep:e=>e>n,getStatus:e=>e<n?"complete":e>n?"incomplete":"active",goToNext(){i(e=>"number"==typeof a?Math.min(a,e+1):e+1)},goToPrevious(){i(e=>Math.max(0,e-1))}}}({index:0,count:E.length}),{toSignIn:a}=(0,I.q)(),[n,i]=(0,x.useState)({email:"",emailCode:"",password:"",passwordCheck:"",username:"",image:""}),[l,s]=(0,x.useState)({loadingEmailCode:!1,loadingEmailCodeSubmit:!1,loadingRegister:!1}),r=()=>t(e=>e+1),o=async()=>{let e=y.instance.checkEmail(n.email);if(!e){alert("이메일 형식이 올바르지 않습니다.");return}s(e=>({...e,loadingEmailCode:!0}));let t=await N.e.requestCode(n.email);if(s(e=>({...e,loadingEmailCode:!1})),t.isError){409===t.statusCode?alert("이미 존재하는 이메일입니다."):alert("인증 코드 요청 실패: ".concat(t.message));return}r()},c=async e=>{s(e=>({...e,loadingEmailCodeSubmit:!0}));let t=await N.e.requestCodeSubmit(n.email,e);if(s(e=>({...e,loadingEmailCodeSubmit:!1})),t.isError){if(401===t.statusCode){alert("인증 코드가 올바르지 않습니다.");return}alert("인증 코드 확인 요청 실패: ".concat(t.message));return}r()},u=async()=>{let e=y.instance.checkPassword(n.password);if(!e){alert("비밀번호 형식이 올바르지 않습니다.");return}if(n.password!==n.passwordCheck){alert("비밀번호가 일치하지 않습니다.");return}let t=y.instance.checkNickname(n.username);if(!t){alert("닉네임 형식이 올바르지 않습니다. (2~10자)");return}s(e=>({...e,loadingRegister:!0}));let i=await N.e.checkUsername(n.username);if(i.isError){409===i.statusCode?alert("이미 존재하는 닉네임입니다."):alert("닉네임 중복 확인 실패: ".concat(i.message)),s(e=>({...e,loadingRegister:!1}));return}let l=await N.e.register(n.email,n.password,n.username,n.imageFile);l.isSuccess?(alert("회원가입이 완료되었습니다."),await a()):alert("회원가입 실패: ".concat(l.message)),s(e=>({...e,loadingRegister:!1}))};return{form:n,handleInputChange:e=>{i({...n,[e.target.name]:e.target.value})},handleImageChange:e=>{if(e.target.files){let t=e.target.files[0];if(t.size>10485760){alert("파일 용량이 너무 큽니다. (10MB 이하)");return}let a=new FileReader;a.onloadend=()=>i({...n,image:a.result,imageFile:t}),a.readAsDataURL(t)}},activeStep:e,setActiveStep:t,steps:E,requestCodeSend:o,requestCodeSubmit:c,requestRegister:u,loadings:l}};var P=a(8049),R=a(9371),q=a(3090),z=a(3108),F=a(3484);let $=e=>{let{handleInputChange:t,requestCodeSend:a,loadingEmailCode:i}=e;return(0,n.jsxs)(P.NI,{isRequired:!0,width:"80%",children:[(0,n.jsx)(R.l,{children:"이메일"}),(0,n.jsx)(q.I,{placeholder:"mindcraft@example.com",mb:3,type:"email",name:"email",onChange:t}),(0,n.jsx)(z.z,{width:"100%",color:"white",bg:F.O.key,onClick:a,isLoading:i,children:"인증 메일 발송"})]})};var K=a(4292),L=a(5225),Z=a(5155),B=a(1103),[M,W,D,G]=(0,L.n)(),[O,T]=(0,l.k)({name:"PinInputContext",errorMessage:"usePinInputContext: `context` is undefined. Seems you forgot to all pin input fields within `<PinInput />`"}),U=e=>null==e?void 0:e.split("");function X(e,t){return("alphanumeric"===t?/^[a-zA-Z0-9]+$/i:/^[0-9]+$/).test(e)}var J=a(2495);function Q(e){let t=(0,h.mq)("PinInput",e),{children:a,...i}=(0,p.Lr)(e),{descendants:l,...s}=function(e={}){let{autoFocus:t,value:a,defaultValue:n,onChange:i,onComplete:l,placeholder:s="○",manageFocus:r=!0,otp:o=!1,id:c,isDisabled:u,isInvalid:m,type:h="number",mask:p}=e,g=(0,x.useId)(),f=null!=c?c:`pin-input-${g}`,j=D(),[C,v]=(0,x.useState)(!0),[w,k]=(0,x.useState)(-1),[b,_]=function(e){let{value:t,defaultValue:a,onChange:n,shouldUpdate:i=(e,t)=>e!==t}=e,l=(0,Z.W)(n),s=(0,Z.W)(i),[r,o]=(0,x.useState)(a),c=void 0!==t,u=c?t:r,d=(0,Z.W)(e=>{let t="function"==typeof e?e(u):e;s(u,t)&&(c||o(t),l(t))},[c,l,u,s]);return[u,d]}({defaultValue:U(n)||[],value:U(a),onChange:e=>null==i?void 0:i(e.join(""))});(0,x.useEffect)(()=>{if(t){let e=j.first();e&&requestAnimationFrame(()=>{e.node.focus()})}},[j]);let S=(0,x.useCallback)(e=>{if(!C||!r)return;let t=j.next(e,!1);t&&requestAnimationFrame(()=>{t.node.focus()})},[j,C,r]),y=(0,x.useCallback)((e,t,a=!0)=>{let n=[...b];n[t]=e,_(n);let i=""!==e&&n.length===j.count()&&n.every(e=>null!=e&&""!==e);i?null==l||l(n.join("")):a&&S(t)},[b,_,S,l,j]),I=(0,x.useCallback)(()=>{var e;let t=Array(j.count()).fill("");_(t);let a=j.first();null==(e=null==a?void 0:a.node)||e.focus()},[j,_]),N=(0,x.useCallback)((e,t)=>{let a=t;return(null==e?void 0:e.length)>0&&(e[0]===t.charAt(0)?a=t.charAt(1):e[0]===t.charAt(1)&&(a=t.charAt(0))),a},[]),E=(0,x.useCallback)(e=>{let{index:t,...a}=e,n=w===t,i="number"===h?"tel":"text";return{"aria-label":"Please enter your pin code",inputMode:"number"===h?"numeric":"text",type:p?"password":i,...a,id:`${f}-${t}`,disabled:u,"aria-invalid":(0,d.Qm)(m),onChange:(0,d.v0)(a.onChange,e=>{let a=e.target.value,n=b[t],i=N(n,a);if(""===i){y("",t);return}if(a.length>2){if(X(a,h)){let e=a.split("").filter((e,t)=>t<j.count());_(e),e.length===j.count()&&(null==l||l(e.join("")))}}else X(i,h)&&y(i,t),v(!0)}),onKeyDown:(0,d.v0)(a.onKeyDown,e=>{var a;if("Backspace"===e.key&&r){if(""===e.target.value){let e=j.prev(t,!1);e&&(y("",t-1,!1),null==(a=e.node)||a.focus(),v(!0))}else v(!1)}}),onFocus:(0,d.v0)(a.onFocus,()=>{k(t)}),onBlur:(0,d.v0)(a.onBlur,()=>{k(-1)}),value:b[t]||"",autoComplete:o?"one-time-code":"off",placeholder:n?"":s}},[j,w,N,f,u,p,m,r,l,o,s,y,_,h,b]);return{getInputProps:E,id:f,descendants:j,values:b,setValue:y,setValues:_,clear:I}}(i),r=(0,J.W)(a).map(e=>(0,x.cloneElement)(e,{__css:t}));return(0,n.jsx)(M,{value:l,children:(0,n.jsx)(O,{value:s,children:r})})}Q.displayName="PinInput";var V=(0,m.G)(function(e,t){let a=function(e={},t=null){let{getInputProps:a}=T(),{index:n,register:i}=G();return a({...e,ref:(0,B.lq)(i,t),index:n})}(e,t);return(0,n.jsx)(g.m.input,{...a,className:(0,d.cx)("chakra-pin-input",e.className)})});V.displayName="PinInputField";let H=e=>{let{requestCodeSubmit:t,loadingEmailCodeSubmit:a}=e;return(0,n.jsx)(i.K,{children:(0,n.jsxs)(P.NI,{display:"flex",flexDirection:"column",justifyContent:"center",isRequired:!0,children:[(0,n.jsx)(R.l,{children:"인증 번호"}),(0,n.jsx)(K.U,{children:(0,n.jsxs)(Q,{onComplete:t,isDisabled:a,children:[(0,n.jsx)(V,{}),(0,n.jsx)(V,{}),(0,n.jsx)(V,{}),(0,n.jsx)(V,{}),(0,n.jsx)(V,{}),(0,n.jsx)(V,{})]})})]})})};var Y=a(5460);let ee=e=>{let{handleInputChange:t,handleImageChange:a,requestRegister:l,loadingRegister:s,image:r}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(i.K,{direction:"row",width:"full",justifyContent:"space-between",children:[(0,n.jsx)(i.K,{width:"55%",display:"flex",alignItems:"center",children:(0,n.jsxs)(P.NI,{isRequired:!0,children:[(0,n.jsx)(R.l,{children:"비밀번호"}),(0,n.jsx)(q.I,{placeholder:"비밀번호",mb:3,type:"password",name:"password",onChange:t}),(0,n.jsx)(q.I,{placeholder:"비밀번호 확인",mb:3,type:"password",name:"passwordCheck",onChange:t}),(0,n.jsx)(R.l,{children:"닉네임"}),(0,n.jsx)(q.I,{placeholder:"닉네임",mb:3,type:"text",name:"username",onChange:t})]})}),(0,n.jsx)(i.K,{width:"40%",display:"flex",alignItems:"center",height:"full",children:(0,n.jsxs)(P.NI,{children:[(0,n.jsxs)(R.l,{boxSize:"full",children:["프로필 이미지",(0,n.jsx)(Y.E,{src:r,aspectRatio:1,objectFit:"cover",borderRadius:8,fallbackSrc:"https://via.placeholder.com/150"})]}),(0,n.jsx)(q.I,{hidden:!0,type:"file",accept:"image/*",name:"image",onChange:a})]})})]}),(0,n.jsx)(z.z,{width:"100%",color:"white",bg:F.O.key,onClick:l,isLoading:s,children:"회원 가입 요청"})]})};var et=a(9094);function ea(){let e=A(),t=e.steps[e.activeStep].description,{auth:a}=(0,et.a)(),{toMain:l}=(0,I.q)();return(0,x.useEffect)(()=>{a&&l()},[]),(0,n.jsxs)(i.K,{maxW:"400px",mx:"auto",my:"8vh",direction:"column",alignItems:"center",children:[(0,n.jsx)(i.K,{width:"100%",children:(0,n.jsx)(f,{width:"60%",mx:"auto",size:"sm",index:e.activeStep,gap:"1",children:e.steps.map((e,t)=>(0,n.jsxs)(j,{children:[(0,n.jsx)(C,{children:(0,n.jsx)(v,{complete:(0,n.jsx)(b,{})})}),(0,n.jsx)(_,{})]},t))})}),(0,n.jsx)(S.X,{width:"full",textAlign:"center",my:30,children:t}),0===e.activeStep?(0,n.jsx)($,{handleInputChange:e.handleInputChange,requestCodeSend:e.requestCodeSend,loadingEmailCode:e.loadings.loadingEmailCode}):1===e.activeStep?(0,n.jsx)(H,{requestCodeSubmit:e.requestCodeSubmit,loadingEmailCodeSubmit:e.loadings.loadingEmailCodeSubmit}):2===e.activeStep?(0,n.jsx)(ee,{handleInputChange:e.handleInputChange,handleImageChange:e.handleImageChange,requestRegister:e.requestRegister,loadingRegister:e.loadings.loadingRegister,image:e.form.image}):null]})}var en=ea}},function(e){e.O(0,[744,774,888,179],function(){return e(e.s=6659)}),_N_E=e.O()}]);